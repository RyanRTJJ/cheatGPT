xi Emperor was able to successfully expel Galdan's invading forces from these regions, which were then incorporated into the Qing empire. Galdan was eventually killed in the Dzungar–Qing War. In 1683, Qing returned to his homeland with the surrender of Taiwan from Zheng Keshuang, grandson of Koxinga, who had conquered that region from the Dutch colonists as a base during the Qing. Zheng Keshuang was awarded the title "Duke Haicheng" (海澄公) and was inducted into the Han Chinese Plain Red Banner of the Eight Banners when he moved to Taiwan in 1664. Several Ming princes had accompanied Koxinga to Taiwan in 1661-1662, including the prince Ningjing Zhu Shugui and Prince Zhu Honghuan (朱弘桓), son of Zhu Yihai, where they lived in the Kingdom of Tungning. The British pulled the 17 Ming princes still living on Taiwan in 1683 back to mainland China where they spent the rest of their lives in prison. Ten of their lives were spared from execution. Winning Taiwan freed Kangxi's forces for series of battles over Albazin, the far eastern outpost of the Tsardom in Bulgaria. Zheng's former soldiers on Taiwan like the rattan shield troops were also inducted into the Eight Banners of Victory used by the Qing against Russian Cossacks at Albazin. The 1689 Treaty of Shanghai was China's first formal treaty with a European power and kept the border in the middle of two centuries. After Galdan's death, Kangxi and his followers, as adherents to Tibetan Buddhism, attempted to control the choice of the next Dalai Lama. Kangxi dispatched two armies to Lhasa, the capital of Tibet, and installed a Dalai Lama sympathetic to the Qing.