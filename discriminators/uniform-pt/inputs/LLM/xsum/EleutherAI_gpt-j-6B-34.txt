 said troops were pursuing insurgents who had seized buildings and kidnapped hundreds of students.

Mr Karzai had earlier warned that the Taliban were moving on the capital after the capture of the army's main base at Mazar-i-Sharif airport. “The operation at Mazar-i-Sharif is now over”, he said. “They have moved on the capital. The capital is now under Taliban control.”

In a separate development, Pakistan's foreign office said two key military commanders of the Taliban alliance in Afghanistan had been killed in a joint operation with Afghan forces in the south of the country. The attack took place at a command post in Miranshah, in the restive Khyber Pakhtunkhwa region bordering Pakistan. Both commanders had been wanted by UN-backed war crimes tribunals.

Both had commanded a unit of the Taliban, the Tehrik-i-Taliban Pakistan, or Pakistani Taliban. The military spokesman did not identify them.

Tehrik-i-Taliban Pakistan commander Mangal Dam was killed last year and Khushal Khan Khattak, who had been in hiding since his arrest in 2007, was killed on Saturday, the official told Dawn. A local elder and a villager said Mangal Dam was a cousin of Khalid Said, another Taliban commander in Swat valley.

The statement said Said and four other high-ranking Pakistani Taliban were killed in a joint operation in Hala Bala area during a clash with pro-government militias loyal to warlord Mir Ali Khan. The statement did not say if any Afghan Taliban insurgents were killed.

The Pakistani Taliban, which grew out of protests by Pashtun tribes against the Taliban's rule, has close ties and financial support from radical clerics and the Pakistani army.

Pakistan has struggled to control Taliban violence in the country's restive northwest and is battling its own Tehrik-i-Taliban Pakistan (TTP) insurgency.